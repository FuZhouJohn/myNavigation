<!DOCTYPE html>
<html lang="zh-Hans">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel='stylesheet' href='./style.css'>
</head>

<body>
  <header></header>
  <main>
    <div id='main'></div>
  </main>
  <footer></footer>
  <script>
    var keys = [['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'], ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l'], ['z', 'x', 'c', 'v', 'b', 'n', 'm', ',']]
    var keyUrls = JSON.parse(localStorage.getItem('keyUrls') || 'null')
    if (!keyUrls) {
      keyUrls = {}
    }
    for (var index = 0; index < keys.length; index++) {
      var div = document.createElement('div')
      main.appendChild(div)
      for (var index2 = 0; index2 < keys[index].length; index2++) {
        
        var button = document.createElement('button')
        button.textContent = '编辑'
        button.id = keys[index][index2]
        button.onclick = function (event) {
          var id = event.target.id
          var input = prompt('请输入要前往的地址', keyUrls[id] || '')
          if (input != null) {
            keyUrls[id] = input
            prevImg = event.target.nextSibling
            console.log(prevImg)
            prevImg.src = 'http://' + input + '/favicon.ico'
            prevImg.onerror = function (img) {
              img.target.src = '//i.ibb.co/wM8BK2c/error-3.png'
            }
            localStorage.setItem('keyUrls', JSON.stringify(keyUrls))
          }
        }

        var icon = document.createElement('img')
        icon.src = 'http://' + keyUrls[keys[index][index2]] + '/favicon.ico'
        icon.onerror = function (img) {
          img.target.src = '//i.ibb.co/wM8BK2c/error-3.png'
        }
        
        var mask = document.createElement('div')
        mask.className = 'mask'
        mask.appendChild(button)
        mask.appendChild(icon)

        var kbd = document.createElement('kbd')
        kbd.textContent = keys[index][index2]
        
        var divwapper = document.createElement('div')
        divwapper.appendChild(mask)
        divwapper.appendChild(kbd)

        div.appendChild(divwapper)
      }
    }


    //监听键盘按下
    document.onkeypress = function (event) {
      var key = event['key']
      if (keyUrls[key]) {
        window.open('http://' + keyUrls[key], '_blank')
      } else {
        console.log('未设置按键')
      }
    }
  </script>
</body>

</html>